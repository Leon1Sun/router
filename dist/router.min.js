!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}window.Router=function(){var t=function(){var t=void 0;return function(e){return e&&(t=e),t}}(),e=function e(i){if(r(this,e),t())return t();var o=n(1),s=new o(i);this._hash=s.tagName,this.$when=function(t,e){return s.$$when(t,e)},t(this)};return e}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(2),s=n(3),a=n(4),c=function(){var t=void 0;return function(e){return e&&(t=e),t}}(),u=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rt-view";return r(this,t),c()?c():("undefined"!=typeof document?this.body=document.getElementsByTagName("BODY")[0]:this.body={},this.tagName=n,this.rootEle=o.getXPath(n),this.scriptManager={},this.routeMap=new s,this.routeMap.contains("")||this.routeMap.set("",new a(this.rootEle.innerHTML,"")),this.oldHash=location.hash.replace("#",""),function(){window.onhashchange=function(t){e.$$refreshView(location.hash)},console.debug("bind tag : "+n+" success")}(),this.$$refreshView(location.hash,!0),void c(this))}return i(t,[{key:"$$refreshView",value:function(t,e){t=t.replace("#","");var n=this;this.routeMap.contains(t)&&this.routeMap.getAsync(t).then(function(e){n.rootEle.innerHTML=e.template,n.oldHash=t,n.$$clearScript(t),n.$$evalScript(t)}).then(function(){e||n.routeMap.getAsync(n.oldHash).then(function(t){t.template=n.rootEle.innerHTML})})}},{key:"$$clearScript",value:function(t){for(var e in this.scriptManager)if(e!=t){var n=document?null:document.getElementById("s_"+e);n&&this.body.removeChild(n)}}},{key:"$$evalScript",value:function(t){try{var e=this;this.routeMap.getAsync(t).then(function(n){var r=n.script||"",i=document.createElement("script");i.id="s_"+t,i.type="text/javascript",i.innerHTML=r,e.body.appendChild(i),e.scriptManager[t]=r})}catch(t){throw t}}},{key:"$$when",value:function(t,e){var n=new a(e.template,e.script,e.templateUrl,e.scriptUrl);this.routeMap.set(t,n),location.hash=="#"+t&&this.$$refreshView(location.hash,!0)}}]),t}();t.exports=u},function(t,e){"use strict";t.exports={getResourcePromise:function(t){return new Promise(function(e,n){var r,i=function(){return"undefined"!=typeof window&&window.XMLHttpRequest?new XMLHttpRequest:new ActiveObject("Micrsorf.XMLHttp")}();i.onreadystatechange=function(){switch(i.readyState){case 3:console.log(3,"正在接受部分响应....."),r=i.responseText;break;case 4:i.status>=200&&i.status<300||304==i.status?e(r):n()}},i.open("get",t),i.send(null)})},getEmptyPromise:function(){return new Promise(function(t,e){t()})},getXPath:function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rt-view";if(document.evaluate){if(t=document.evaluate("//*[@"+n+"]",document),e=t.iterateNext())return e;throw"can't find rt-view"}if(document.selectNodes){if(t=document.selectNodes("//*[@rt-view]"),!t||!t.length||t.length<=0)throw"can't find rt-view";return t[0]}}}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(4),s=function(){function t(){r(this,t),this.keys=[],this.configs=[]}return i(t,[{key:"getAsync",value:function(t){var e=this.keys.indexOf(t);if(e>=0){var n=this.configs[e];return n.async()}}},{key:"set",value:function(t,e){if(!e instanceof o)return console.warn("config is not instanceof RouteConfig"),!1;var n=this.keys.indexOf(t);n>0?this.configs[n]=e:(this.keys.push(t),this.configs.push(e))}},{key:"contains",value:function(t){return this.keys.indexOf(t)>=0}},{key:"size",value:function(){return this.keys.length}}]),t}();t.exports=s},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(2),s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";r(this,t),this.template=e||"",this.script=n||"",this.templateUrl=i,this.scriptUrl=o}return i(t,[{key:"async",value:function(){var t=this;return""==this.template&&""!=this.templateUrl&&""!=this.script?o.getResourcePromise(this.templateUrl).then(function(e){return t.template=e,t}):""==this.script&&""!=this.scriptUrl&&""!=this.template?o.getResourcePromise(this.scriptUrl).then(function(e){return t.script=e,t}):""==this.script&&""!=this.scriptUrl&&""==this.template&&""!=this.templateUrl?Promise.all([o.getResourcePromise(this.templateUrl),o.getResourcePromise(this.scriptUrl)]).then(function(e){return console.log(self),t.template=e[0],t.script=e[1],console.log(t),t}):o.getEmptyPromise().then(function(){return t})}}]),t}();t.exports=s}]);